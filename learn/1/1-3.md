### Day 3：账户接口（只用测试环境）

#### •	CEX 余额 ≠ 链上余额
#### •	是数据库余额

| 字段 | 含义 |
| --- | --- |
| free | 可用余额 |
| used | 冻结资金（下单中） |
| total | 总资产 |

#### 一、核心原则（先记住这 3 条）

1️⃣ 测试 API ≠ 主网 API
2️⃣ 测试 API 没有真实资产
3️⃣ 测试 API 也需要权限控制


### Binance 测试 API_KEY 申请（推荐新手）

✅ 正确入口（不是主站 API）

Binance 有 专门的 Testnet

1️⃣ 打开 Binance Testnet

- [Binance Testnet](https://testnet.binance.vision)

#### 注意
- 不是 https://www.binance.com
- 是 https://testnet.binance.vision

#### API 权限（非常重要）

#### 勾选
- Enable Reading
- Enable Spot & Margin Trading（如果你要下单）

#### 不要勾选
- Withdraw（测试也别勾）

### 三、OKX 测试 API_KEY 申请（进阶推荐）


#### 重要：最常见 5 个坑（提前避）

❌ 用主站 API Key 打 testnet
❌ 忘记 setSandboxMode(true)
❌ API 没开交易权限
❌ IP 限制没配
❌ 把 Key 提交到 GitHub


---

## 关于Binance 测试 API_KEY

### TRADE, USER_DATA, USER_STREAM 权限是否过大

 <!-- 结论先行（重点）

在测试环境里：不算过大
在主网环境里：对新手来说偏大 -->

| 权限 | 能做什么 | 风险等级 |
| --- | --- | --- |
| USER_DATA | 查余额、订单、账户信息 | ⭐ |
| TRADE | 下单、撤单 | ⭐⭐⭐ |
| USER_STREAM | 订阅账户实时推送 | ⭐⭐ |

1️⃣ USER_DATA（只读权限）

**允许的操作**
- 查余额
- 查订单
- 查成交记录

**本质**
- 数据库 SELECT
- 不动资金
- 主网 & 测试网都安全

⸻

2️⃣ TRADE（交易权限）

**允许的操作**
- 买入 / 卖出
- 撤单
- 冻结资金

**本质**
- 改数据库状态
- 不直接出金

**风险点**
- 可能亏钱
- 可能乱下单

- 测试环境：必须开
- 主网：慎开

⸻

3️⃣ USER_STREAM（账户推送）

允许的操作
	•	WebSocket 推送余额变化
	•	推送订单成交

📌 本质

消息订阅
❌ 不改状态

✔ 安全
✔ 专业交易系统必备

⸻

三、权限“是否过大”的正确判断标准

❌ 错误判断方式

“权限越少越安全”

✅ 正确判断方式

是否违反最小权限原则（Least Privilege）

四、不同阶段的正确权限配置
🧪 测试环境（你现在这个阶段）
USER_DATA      ✅ 必须
TRADE          ✅ 必须
USER_STREAM    ✅ 推荐
Withdraw       ❌ 绝对禁止
👉 这是“标准测试权限”


🚀 主网·开发阶段
USER_DATA      ✅
TRADE          ❌（除非必要）
USER_STREAM    ❌ 可选
Withdraw       ❌

七、工程师级安全建议（你已经可以用）

1️⃣ API Key 永远不进前端
2️⃣ 测试 Key 与 主网 Key 物理隔离
3️⃣ .env + IP 白名单
4️⃣ 主网永远不用“全权限 Key”
5️⃣ 日志永不打印 Secret